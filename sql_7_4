WITH many_ways AS
(SELECT CONNECT_BY_ROOT "Номер родительской вершины" "Начальная вершина",
"Номер дочерней вершины" "Конечная вершина",
DECODE(LEVEL, 1, "Количество",
              2, CONNECT_BY_ROOT "Количество" * "Количество",
              3, CONNECT_BY_ROOT "Количество" * PRIOR "Количество" *
              "Количество") "Произв кол-в (в пути)"
FROM table_7_4 outer_table
START WITH "Номер родительской вершины"=(SELECT DISTINCT "Номер родительской вершины"
FROM table_7_4
WHERE "Номер родительской вершины"=outer_table."Номер родительской вершины")
CONNECT BY PRIOR "Номер дочерней вершины"="Номер родительской вершины")
SELECT "Начальная вершина", "Конечная вершина", COUNT(*) "Количество путей",
SUM("Произв кол-в (в пути)") "Сумма произведений"
FROM many_ways
GROUP BY "Начальная вершина", "Конечная вершина"
ORDER BY "Начальная вершина";
